<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Omni Invite Card Generator</title>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Great+Vibes&family=Roboto&display=swap" rel="stylesheet">
<style>
body {
  margin:0;
  font-family:Roboto,sans-serif;
  overflow-x:hidden;
  background:#111;
}

/* Dynamic Gradient Background + Snow */
body::before{
  content:"";
  position:fixed; inset:0; z-index:-2;
  background:linear-gradient(45deg,#ff0080,#ff8c00,#40e0d0,#8a2be2);
  background-size:600% 600%;
  animation:bgGradient 20s infinite linear;
}
@keyframes bgGradient{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

/* Snow Effect */
#snowCanvas{
  position:fixed; top:0; left:0; width:100%; height:100%; z-index:-1; pointer-events:none;
}

.app-container{
  display:flex; gap:20px; padding:20px; flex-wrap:wrap;
}
.controls{
  flex:1; min-width:300px;
  background:rgba(255,255,255,0.95);
  border-radius:15px; padding:20px;
}
.controls h2{text-align:center;margin-bottom:5px}
.controls small{text-align:center;display:block;color:#555}
label{font-weight:bold;margin-top:10px;display:block;}
input,select,textarea{width:100%;padding:8px;margin-top:5px;}
button{width:100%;margin-top:10px;padding:10px;background:#ff0066;color:#fff;border:none;cursor:pointer;font-weight:bold;}
.card-preview{
  flex:2; min-height:450px; display:flex; gap:20px; justify-content:center; align-items:flex-start; flex-wrap:wrap;
}
.card{
  width:300px; min-height:380px; background:white; border-radius:15px; position:relative; overflow:hidden;
  box-shadow:0 15px 40px rgba(0,0,0,.5); transition:all 0.3s;
}
.card img.bg-img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;z-index:0;}
.watermark{position:absolute;bottom:10px;right:10px;font-size:11px;opacity:.35;}
.highlight{position:absolute;cursor:move;padding:4px 8px;border-radius:6px;user-select:none;z-index:1;}

/* Premium blur */
.premium-only{filter:blur(4px);pointer-events:none;opacity:.6;}
.premium-unlocked{filter:none;pointer-events:auto;opacity:1;}

/* Unlocked badge */
.badge{position:fixed;top:15px;right:15px;background:#00ffcc;color:#000;padding:8px 12px;border-radius:20px;font-weight:bold;display:none;animation:pulse 1.5s infinite;}
@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}

/* Hearts */
.heart{position:absolute;width:18px;height:18px;background:pink;transform:rotate(45deg);animation:float linear infinite;}
.heart::before,.heart::after{content:"";position:absolute;width:18px;height:18px;background:pink;border-radius:50%;}
.heart::before{top:-9px;} .heart::after{left:-9px;}
@keyframes float{0%{bottom:-20px;opacity:1}100%{bottom:420px;opacity:0}}
</style>
</head>

<body>
<canvas id="snowCanvas"></canvas>
<div class="badge" id="badge">‚úÖ PRO UNLOCKED</div>
<div class="app-container">
  <div class="controls">
    <h2>Omni Invite Card Generator</h2>
    <small>* Blurred options are PRO features</small>

    <label>Invitee Name</label>
    <input id="name" placeholder="John Doe">

    <label>Message</label>
    <textarea id="msg">You are invited!</textarea>

    <label>Font</label>
    <select id="font">
      <option value="Roboto">Roboto</option>
      <option value="Pacifico">Pacifico</option>
      <option value="Great Vibes">Great Vibes</option>
    </select>

    <label>Font Size</label>
    <input type="number" id="fontSize" value="24" min="12" max="72">

    <label>Text Color</label>
    <input type="color" id="txtColor" value="#000000">

    <label>Text Background</label>
    <input type="color" id="txtBg" value="#ffffff">

    <label>Text Animation</label>
    <select id="txtAnim">
      <option value="none">None</option>
      <option value="fade">Fade</option>
      <option value="bounce">Bounce</option>
      <option value="slide">Slide</option>
    </select>

    <label>Card Background Color</label>
    <input type="color" id="bgColor" value="#ffffff">

    <label>Card Background Image</label>
    <input type="file" id="bgImage" accept="image/*">

    <label>Card Border Radius</label>
    <input type="number" id="borderRad" value="15" min="0" max="50">

    <label>Box Shadow (px blur spread)</label>
    <input type="text" id="boxShadow" value="0 15 40">

    <label>Upload Background Music (Optional)</label>
    <input type="file" id="bgMusic" accept="audio/*">

    <!-- Premium features -->
    <label class="premium-only">Number of Cards *</label>
    <select id="count" class="premium-only"><option value="1">1</option><option value="2">2</option><option value="3">3</option></select>

    <label class="premium-only">Template *</label>
    <select id="template" class="premium-only"><option value="none">None</option><option value="wedding">Wedding ‚ù§Ô∏è</option></select>

    <div style="margin-top:10px;border:2px dashed #ff0066;padding:10px;border-radius:10px;background:#fff0f6;">
      <strong>üîí Unlock PRO Features</strong>
      <p>Moniepoint Account: <strong>8034494412</strong></p>
      <p>Contact via WhatsApp after payment:</p>
      <a href="https://wa.me/2349124623012?text=Hi%20Omni%20Invite%20Card%20Generator!%20I%20have%20paid%20and%20need%20my%20one-time%20code." target="_blank">üí¨ +2349124623012</a>
    </div>

    <label>Upload Payment Proof</label>
    <input type="file" id="proof" accept="image/*,application/pdf">

    <label>Enter Premium Code</label>
    <input id="code" placeholder="One-time code">
    <button id="unlockBtn">Unlock Premium</button>

    <button onclick="generateCards()">Generate Card(s)</button>
  </div>

  <div class="card-preview" id="preview"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
// ===== Dynamic Gradient Snow Background =====
const snowCanvas=document.getElementById('snowCanvas'),snowCtx=snowCanvas.getContext('2d');
let snowflakes = [];
function resizeSnow(){snowCanvas.width=innerWidth;snowCanvas.height=innerHeight;}
resizeSnow();window.onresize=resizeSnow;
for(let i=0;i<150;i++){snowflakes.push({x:Math.random()*innerWidth,y:Math.random()*innerHeight,r:Math.random()*2+1,speed:Math.random()*1+0.2})}
function snowAnim(){
  snowCtx.clearRect(0,0,snowCanvas.width,snowCanvas.height);
  snowflakes.forEach(s=>{
    snowCtx.beginPath();
    snowCtx.arc(s.x,s.y,s.r,0,2*Math.PI);
    snowCtx.fillStyle="white";snowCtx.fill();
    s.y+=s.speed; if(s.y>snowCanvas.height)s.y=0;
  });
  requestAnimationFrame(snowAnim);
}
snowAnim();

// ===== Core Card Logic =====
const preview=document.getElementById("preview");
const badge=document.getElementById("badge");
const unlockBtn=document.getElementById("unlockBtn");
const validCodes=["OMNI2026","OMNI207","OMNI4"];
const premiumEls=document.querySelectorAll(".premium-only");
let premium=localStorage.getItem("premium")==="yes";

function unlock(){
  premium=true;
  localStorage.setItem("premium","yes");
  badge.style.display="block";
  premiumEls.forEach(el=>el.classList.add("premium-unlocked"));
}

if(premium) unlock();

// Unlock button
unlockBtn.onclick=()=>{
  const codeInput=document.getElementById("code");
  const code=codeInput.value.trim();
  if(localStorage.getItem("usedCode")){
    alert("This device already used a code.");
    return;
  }
  if(validCodes.includes(code)){
    localStorage.setItem("usedCode",code);
    unlock();
    alert("Premium unlocked üéâ");
    generateCards();
  } else alert("Invalid code");
};

// Generate Cards
function generateCards(){
  preview.innerHTML="";
  const total=premium?parseInt(document.getElementById("count").value):1;
  for(let i=0;i<total;i++){
    const card=document.createElement("div"); card.className="card";
    
    // Background image
    const bgFile=document.getElementById("bgImage").files[0];
    if(bgFile){
      const img=document.createElement("img"); img.className="bg-img";
      img.src=URL.createObjectURL(bgFile);
      card.appendChild(img);
    }

    // Music
    const musicFile=document.getElementById("bgMusic").files[0];
    if(musicFile){
      const audio=document.createElement("audio"); audio.src=URL.createObjectURL(musicFile);
      audio.loop=true; audio.autoplay=false; audio.controls=true;
      audio.style.position="absolute"; audio.style.bottom="0"; audio.style.width="100%";
      card.appendChild(audio);
    }

    card.innerHTML+=`
      <h1><span class="highlight" style="top:30px;left:20px;">Name</span></h1>
      <p><span class="highlight" style="top:120px;left:20px;">Message</span></p>
      ${!premium?`<div class='watermark'>Omni Invite</div>`:""}
    `;
    preview.appendChild(card);

    const [n,m]=card.querySelectorAll(".highlight");
    n.textContent=document.getElementById("name").value||"Name";
    m.textContent=document.getElementById("msg").value||"Message";
    const font=document.getElementById("font").value;
    const size=document.getElementById("fontSize").value;
    const color=document.getElementById("txtColor").value;
    const bg=document.getElementById("txtBg").value;
    const anim=document.getElementById("txtAnim").value;
    [n,m].forEach(e=>{
      e.style.color=color; e.style.background=bg;
      e.style.fontFamily=font; e.style.fontSize=size+"px";
      e.style.animation=(anim!=="none")?`${anim} 2s infinite`:"";
      drag(e,card);
    });

    // Card styles
    const bColor=document.getElementById("bgColor").value;
    const br=document.getElementById("borderRad").value;
    const bs=document.getElementById("boxShadow").value;
    card.style.backgroundColor=bColor;
    card.style.borderRadius=br+"px";
    card.style.boxShadow=bs+"px rgba(0,0,0,0.5)";

    // Template hearts
    if(premium && document.getElementById("template").value==="wedding"){
      for(let j=0;j<10;j++){
        const h=document.createElement("div"); h.className="heart";
        h.style.left=Math.random()*260+"px"; card.appendChild(h);
      }
    }
  }
}

// Drag function
function drag(el,card){
  let d=false,ox,oy;
  el.onmousedown=e=>{d=true; ox=e.offsetX; oy=e.offsetY;}
  document.onmousemove=e=>{
    if(!d)return;
    el.style.left=e.pageX-card.offsetLeft-ox+"px";
    el.style.top=e.pageY-card.offsetTop-oy+"px";
  }
  document.onmouseup=()=>d=false;
}

// Auto-generate on input
const inputs=[document.getElementById("name"),document.getElementById("msg"),document.getElementById("txtColor"),document.getElementById("txtBg"),document.getElementById("font"),document.getElementById("txtAnim"),document.getElementById("fontSize"),document.getElementById("bgColor"),document.getElementById("borderRad"),document.getElementById("boxShadow"),document.getElementById("template"),document.getElementById("count")];
inputs.forEach(inp=>inp.oninput=generateCards);
generateCards();
</script>
</body>
</html>